{% raw %}
groups:
- name: common_alert.rules
  rules:
  - alert: InstanceDown
    expr: up == 0
    for: 10m
    labels:
      severity: page
    annotations:
      description: '{{$labels.instance}} of job {{$labels.job}} has been down for
        more than 5 minutes'
      summary: Instance {{$labels.instance}} is down
  - alert: InstanceHighCpu
    expr: 100 - (avg(irate(node_cpu{mode="idle"}[5m])) BY (host) * 100) > 35
    for: 10m
    labels:
      severity: page
    annotations:
      description: '{{$labels.instance}} has high cpu activity'
      summary: 'Instance {{$labels.instance}}: cpu high'
  - alert: InstanceLowMemory
    expr: (node_memory_MemFree + node_memory_Cached + node_memory_Buffers) / node_memory_MemTotal
      * 100 < 10
    for: 5m
    labels:
      severity: page
    annotations:
      description: '{{$labels.instance}} has less than 10% memory available'
      summary: 'Instance {{$labels.instance}}: memory low'
  - alert: InstanceLowDisk
    expr: node_filesystem_avail{mountpoint="/"} < 5.36870912e+08
    for: 10m
    labels:
      severity: page
    annotations:
      description: '{{$labels.instance}} has less than 2G FS space'
      summary: 'Instance {{$labels.instance}}: low disk space'
  - alert: NodeLoadAverage
    expr: ((node_load5 / count(node_cpu{mode="system"}) WITHOUT (cpu, mode)) > 1)
    for: 2m
    labels:
      severity: page
    annotations:
      DESCRIPTION: '{{$labels.instance}}: LA is high'
      SUMMARY: '{{$labels.instance}}: High LA detected with value {{ $value }}'
{% endraw %}
